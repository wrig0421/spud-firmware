// SRW

#include "stm32l4xx_hal.h"
#include "board_specific.h"
#include "spi_access.h"


void spi_access_setup(void)
{
    RCC_PeriphCLKInitTypeDef PeriphClkInit = {0};

//    PeriphClkInit.PeriphClockSelection = RCC_PERIPHCLK_SPI1;
//    PeriphClkInit.Lpuart1ClockSelection = RCC_SPI1CLKSOURCE_HSI;
//
//    if (HAL_RCCEx_PeriphCLKConfig(&PeriphClkInit) != HAL_OK)
//    {
//        while(1);
//      //Error_Handler();
//    }
    //__HAL_RCC_LPUART1_CLK_ENABLE();
    GPIO_InitTypeDef  GPIO_InitStruct;

    GPIO_InitStruct.Pin         = PIN_SPI1_SCK | PIN_SPI1_CIPO | PIN_SPI1_COPI;
    GPIO_InitStruct.Mode        = GPIO_MODE_AF_PP;
    GPIO_InitStruct.Pull        = GPIO_PULLDOWN;
    GPIO_InitStruct.Speed       = GPIO_SPEED_FREQ_VERY_HIGH;
    GPIO_InitStruct.Alternate   = GPIO_AF5_SPI1;
    HAL_GPIO_Init(PIN_PORT_A, &GPIO_InitStruct);

    serial_com_init_spi();
}

